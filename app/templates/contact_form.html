{% extends "base.html" %}

{% block title %}{{ 'Edit Contact' if contact else 'Add Guest' }}{% endblock %}

{% block content %}
<h2>{{ 'Edit Contact' if contact else 'Add Guest' }}</h2>
<form method="POST"
    action="{{ url_for('contacts_bp.contact_form', contact_id=contact.id) if contact else url_for('contacts_bp.contact_form') }}">
    <table class="form-table">
        <tr>
            <td><label for="first_name">First Name: <span class="required-field">*</span></label></td>
            <td><input type="text" id="first_name" name="first_name" value="{{ contact.first_name if contact else '' }}" required></td>
        </tr>
        <tr>
            <td><label for="last_name">Last Name:</label></td>
            <td><input type="text" id="last_name" name="last_name" value="{{ contact.last_name if contact else '' }}"></td>
        </tr>
        <input type="hidden" id="type" name="type" value="{{ contact.Type if contact else 'Guest' }}">
        <input type="hidden" id="name" name="name" value="{{ contact.Name if contact else '' }}">
        <tr id="member_id_row" {% if contact and contact.Type == 'Guest' %}style="display: none;"{% endif %}>
            <td><label for="member_id">Member ID:</label></td>
            <td><input type="text" id="member_id" name="member_id" value="{{ contact.Member_ID if contact else '' }}"></td>
        </tr>
        <tr id="mentor_id_row" {% if contact and contact.Type == 'Guest' %}style="display: none;"{% endif %}>
            <td><label for="mentor_id">Mentor:</label></td>
            <td>
                <select id="mentor_id" name="mentor_id">
                    <option value="">None</option>
                    {% for mentor in mentor_candidates %}
                    <option value="{{ mentor.id }}" {% if contact and contact.Mentor_ID == mentor.id %}selected{% endif %}>
                        {{ mentor.Name }}
                    </option>
                    {% endfor %}
                </select>
            </td>
        </tr>
        <tr>
            <td><label for="completed_paths">Completed Paths:</label></td>
            <td><input type="text" id="completed_paths" name="completed_paths"
                    value="{{ contact.Completed_Paths if contact else '' }}" placeholder="e.g., PM1, DL2..."></td>
        </tr>
        <tr>
            <td><label for="dtm">DTM:</label></td>
            <td><input type="checkbox" id="dtm" name="dtm" {% if contact and contact.DTM %}checked{% endif %}></td>
        </tr>
    </table>
    <div class="form-actions">
        <button type="submit" class="btn btn-success">Save</button>
        <a href="{{ url_for('contacts_bp.show_contacts') }}" class="btn btn-danger">Cancel</a>
    </div>
</form>
{% endblock %}