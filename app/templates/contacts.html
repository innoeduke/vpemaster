{% extends "base.html" %} {% block title %}Contacts{% endblock %} {% block
content %}
<h1>Contacts</h1>
<div class="action-bar" style="justify-content: center">
  <div class="search-container">
    <input
      type="text"
      id="searchInput"
      placeholder="Search all columns..."
      class="search-box"
    />
    <button
      id="clear-searchInput"
      class="clear-search-btn"
      style="display: none"
    >
      &times;
    </button>
  </div>
  {% if is_authorized(session.get('user_role'), 'CONTACT_BOOK_EDIT') %}
  <button
    class="btn btn-primary"
    onclick="openContactModal()"
    style="margin-left: 10px"
  >
    New Contact
  </button>
  <button
    class="btn btn-info"
    onclick="window.location.href='{{ url_for('roster_bp.roster') }}'"
    style="margin-left: 10px"
  >
    Open Roster</button
  >{% endif %}
</div>

<table id="contactsTable">
  <thead>
    <tr>
      <th class="sortable" data-column-index="1">Name</th>
      <th class="sortable" data-column-index="2">Type</th>
      <th class="sortable" data-column-index="3">Club</th>
      <th class="sortable" data-column-index="4">Working Path</th>
      <th class="sortable" data-column-index="5">Next Project</th>
      <th class="sortable" data-column-index="6">Completed Levels</th>
      {% if is_authorized(session.get('user_role'), 'CONTACT_BOOK_EDIT') %}
      <th data-column-index="7">Actions</th>
      {% endif %}
    </tr>
  </thead>
  <tbody>
    {% for contact in contacts %}
    <tr>
      <td>
        {{ contact.Name }} {% if contact.DTM %}
        <sup class="dtm-superscript">DTM</sup>
        {% endif %}
      </td>
      <td>{{ contact.Type }}</td>
      <td>{{ contact.Club }}</td>
      <td>{% if contact.user %}{{ contact.user.Current_Path }}{% endif %}</td>
      <td>{% if contact.user %}{{ contact.user.Next_Project }}{% endif %}</td>
      <td>{{ contact.Completed_Levels }}</td>
      {% if is_authorized(session.get('user_role'), 'CONTACT_BOOK_EDIT') %}
      <td>
        <div class="action-links">
          <button
            class="icon-btn"
            onclick="openContactModal({{ contact.id }})"
            title="Edit"
          >
            <i class="fas fa-edit"></i>
          </button>
          <button
            class="delete-btn icon-btn"
            onclick="openDeleteModal('{{ url_for('contacts_bp.delete_contact',contact_id=contact.id) }}', 'contact')"
            title="Delete"
          >
            <i class="fas fa-trash-alt"></i>
          </button>
        </div>
      </td>
      {% endif %}
    </tr>
    {% endfor %}
  </tbody>
</table>

{% include '_contact_modal.html' %}
<script src="{{ url_for('static', filename='js/contacts.js') }}"></script>

{% endblock %}
