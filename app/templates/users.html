{% extends "base.html" %}

{% block title %}User List{% endblock %}

{% block content %}
<h1>User Management</h1>
<a href="{{ url_for('users_bp.user_form') }}" class="btn btn-primary">Add New User</a>

<table>
    <thead>
        <tr>
            <th>No.</th>
            <th>Username</th>
            <th>Full Name</th>
            <th>Role</th>
            <th>Date Created</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for user in users %}
        <tr class="{{ 'inactive-user' if user.status == 'inactive' else '' }}">
            <td>{{ loop.index }}</td>
            <td>{{ user.username }}</td>
            <td>
                {% if user.contact %}
                {{ user.contact.Name }}
                {% else %}
                <em style="color: #888;">Not Linked</em>
                {% endif %}
            </td>
            <td>
                {% set role = user.primary_role %}
                {% set role_class = 'role-' ~ role.award_category if (role and role.award_category) else 'role-other' %}
                {% if role and role.type == 'officer' %}
                    {% set role_class = 'role-officer' %}
                {% endif %}
                <span class="roster-role-tag {{ role_class }}">{{ user.primary_role_name }}</span>
            </td>
            <td>{{ user.created_at.strftime('%Y-%m-%d') if user.created_at else '' }}</td>
            <td>
                <div class="action-links">
                    <a href="{{ url_for('users_bp.user_form', user_id=user.id) }}" class="icon-btn" title="Edit"><i
                            class="fas fa-edit"></i></a>
                    <button class="delete-btn icon-btn"
                        onclick="openDeleteModal('{{ url_for('users_bp.delete_user', user_id=user.id) }}', 'user')"
                        title="Delete"><i class="fas fa-trash-alt"></i></button>
                </div>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}